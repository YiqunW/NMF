K values determined:
[5, 6, 7, 8, 9, 10]
Reading data...
Expression data read. Dataset dimensions:
(1860, 325)
Setting parameters for class nmf_reps...
Setting datasets for class nmf_reps...
Removing 2 all-zero rows and 0 all-zero columns...
Scaling expression data by non-zero median...
Permuting scaled expression data...
Running nmf...
Running NMF for K=5...
Running rep0:
error: 828.631089835
n_iter: 865
Running rep1:
error: 828.631089835
n_iter: 865
Running rep2:
error: 828.631089835
n_iter: 865
Running rep3:
error: 828.631089835
n_iter: 865
Running rep4:
error: 828.631089835
n_iter: 865
  running permuted dataset...
Running rep0:
error: 917.421756687
n_iter: 1430
Running rep1:
error: 917.421757996
n_iter: 1298
Running rep2:
error: 917.421756455
n_iter: 1423
Running rep3:
error: 917.421757742
n_iter: 1321
Running rep4:
error: 917.494878224
n_iter: 3510
Running NMF for K=6...
Running rep0:
error: 821.504602091
n_iter: 857
Running rep1:
error: 821.504602092
n_iter: 857
Running rep2:
error: 821.504602091
n_iter: 857
Running rep3:
error: 821.504602091
n_iter: 857
Running rep4:
error: 821.504602091
n_iter: 857
  running permuted dataset...
Running rep0:
error: 914.396391514
n_iter: 1536
Running rep1:
error: 914.396381408
n_iter: 1982
Running rep2:
error: 914.309053331
n_iter: 4822
Running rep3:
error: 914.396381296
n_iter: 1953
Running rep4:
error: 914.396391226
n_iter: 1646
Running NMF for K=7...
Running rep0:
error: 814.460242576
n_iter: 895
Running rep1:
error: 814.460242575
n_iter: 895
Running rep2:
error: 814.460242576
n_iter: 895
Running rep3:
error: 814.460242576
n_iter: 895
Running rep4:
error: 814.460242576
n_iter: 895
  running permuted dataset...
Running rep0:
error: 911.301357825
n_iter: 5084
Running rep1:
error: 911.328465061
n_iter: 3765
Running rep2:
error: 911.2295554
n_iter: 8372
Running rep3:
error: 911.301382863
n_iter: 3551
Running rep4:
error: 911.301359505
n_iter: 4057
Running NMF for K=8...
Running rep0:
error: 809.575261738
n_iter: 1610
Running rep1:
error: 809.575261727
n_iter: 1610
Running rep2:
error: 809.575261727
n_iter: 1610
Running rep3:
error: 809.575261736
n_iter: 1610
Running rep4:
error: 809.57526174
n_iter: 1610
  running permuted dataset...
Running rep0:
error: 908.352871881
n_iter: 3859
Running rep1:
error: 908.352878361
n_iter: 3916
Running rep2:
error: 908.352877743
n_iter: 3568
Running rep3:
error: 908.352872389
n_iter: 3055
Running rep4:
error: 908.352878355
n_iter: 3398
Running NMF for K=9...
Running rep0:
error: 805.584843059
n_iter: 977
Running rep1:
error: 805.58484306
n_iter: 977
Running rep2:
error: 805.584843045
n_iter: 977
Running rep3:
error: 805.584843043
n_iter: 977
Running rep4:
error: 805.584843035
n_iter: 977
  running permuted dataset...
Running rep0:
error: 905.643778905
n_iter: 3977
Running rep1:
error: 905.687544124
n_iter: 5341
Running rep2:
error: 905.64378091
n_iter: 5069
Running rep3:
error: 905.643814651
n_iter: 3735
Running rep4:
error: 905.63464024
n_iter: 5406
Running NMF for K=10...
Running rep0:
error: 801.707825018
n_iter: 1055
Running rep1:
error: 801.707825063
n_iter: 1055
Running rep2:
error: 801.707825006
n_iter: 1054
Running rep3:
error: 801.707825005
n_iter: 1055
Running rep4:
error: 801.707824993
n_iter: 1055
  running permuted dataset...
Running rep0:
error: 902.959299401
n_iter: 5409
Running rep1:
error: 902.95930979
n_iter: 5047
Running rep2:
error: 902.959299699
n_iter: 7458
Running rep3:
error: 902.959309929
n_iter: 6045
Running rep4:
error: 902.959308349
n_iter: 6604
NMF runs finished. Results are stored in run_nmf.results and run_nmf.permuted_results.
Pickling the result object as ../example_results_new//Results_obj_688617.pkl...
Plotting reconstruction errors and actual iteration numbers...
Plotting ratios between the 2 top ranking genes...
Calculating result stability measurements...
Calculating stability for results...
Calculating stats on matrices G for K=5...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices G for K=6...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices G for K=7...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices G for K=8...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices G for K=9...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices G for K=10...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices C for K=5...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices C for K=6...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices C for K=7...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices C for K=8...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices C for K=9...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices C for K=10...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stability for results from permuted dataset...
Calculating stats on matrices G for K=5...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices G for K=6...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices G for K=7...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices G for K=8...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices G for K=9...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices G for K=10...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices C for K=5...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices C for K=6...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices C for K=7...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices C for K=8...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices C for K=9...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Calculating stats on matrices C for K=10...
building connectivity matrix for rep2...
building connectivity matrix for rep0...
building connectivity matrix for rep3...
building connectivity matrix for rep4...
building connectivity matrix for rep1...
Plotting result stability...
Pickling the result object with stability table(s)...
All done.
Run time: 249s
