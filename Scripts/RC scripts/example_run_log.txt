K values determined:
[5, 6, 7, 8, 9, 10]
Setting parameters for class nmf_reps...
Expression data read. Dataset dimensions:
(1860, 325)
Setting datasets for class nmf_reps...
Removing 2 all-zero rows and 0 all-zero columns...
Scaling expression data by non-zero median...
Permuting scaled expression data...
Running nmf...
Running NMF for K=5...
Running rep0:
error: 828.631089835
n_iter: 865
Running rep1:
error: 828.631089835
n_iter: 865
Running rep2:
error: 828.631089835
n_iter: 865
Running rep3:
error: 828.631089835
n_iter: 865
Running rep4:
error: 828.631089835
n_iter: 865
  running permuted dataset...
Running rep0:
error: 917.377351603
n_iter: 4409
Running rep1:
error: 917.377351613
n_iter: 5945
Running rep2:
error: 917.377349982
n_iter: 2672
Running rep3:
error: 917.377352436
n_iter: 4563
Running rep4:
error: 917.377350719
n_iter: 3718
Running NMF for K=6...
Running rep0:
error: 821.504602091
n_iter: 857
Running rep1:
error: 821.504602091
n_iter: 857
Running rep2:
error: 821.504602091
n_iter: 857
Running rep3:
error: 821.504602092
n_iter: 857
Running rep4:
error: 821.504602091
n_iter: 857
  running permuted dataset...
Running rep0:
error: 914.208354743
n_iter: 8394
Running rep1:
error: 914.257421727
n_iter: 9999
Running rep2:
error: 914.235970207
n_iter: 9999
Running rep3:
error: 914.257382738
n_iter: 9999
Running rep4:
error: 914.257406729
n_iter: 9999
Running NMF for K=7...
Running rep0:
error: 814.460242576
n_iter: 895
Running rep1:
error: 814.460242576
n_iter: 895
Running rep2:
error: 814.460242576
n_iter: 895
Running rep3:
error: 814.460242576
n_iter: 895
Running rep4:
error: 814.460242576
n_iter: 895
  running permuted dataset...
Running rep0:
error: 911.2536625
n_iter: 5714
Running rep1:
error: 911.309899905
n_iter: 3871
Running rep2:
error: 911.253694493
n_iter: 3758
Running rep3:
error: 911.253692425
n_iter: 3230
Running rep4:
error: 911.253669982
n_iter: 2880
Running NMF for K=8...
Running rep0:
error: 809.575261725
n_iter: 1610
Running rep1:
error: 809.575261783
n_iter: 1609
Running rep2:
error: 809.575261789
n_iter: 1609
Running rep3:
error: 809.57526174
n_iter: 1610
Running rep4:
error: 809.575261729
n_iter: 1610
  running permuted dataset...
Running rep0:
error: 908.444045502
n_iter: 3059
Running rep1:
error: 908.432695618
n_iter: 3009
Running rep2:
error: 908.422186525
n_iter: 8707
Running rep3:
error: 908.444034546
n_iter: 5210
Running rep4:
error: 908.432701816
n_iter: 2399
Running NMF for K=9...
Running rep0:
error: 805.584843042
n_iter: 977
Running rep1:
error: 805.584843041
n_iter: 977
Running rep2:
error: 805.584843048
n_iter: 977
Running rep3:
error: 805.58484303
n_iter: 977
Running rep4:
error: 805.58484304
n_iter: 977
  running permuted dataset...
Running rep0:
error: 905.673026199
n_iter: 6840
Running rep1:
error: 905.673028651
n_iter: 5463
Running rep2:
error: 905.673028738
n_iter: 5308
Running rep3:
error: 905.673028378
n_iter: 5060
Running rep4:
error: 905.673028063
n_iter: 4361
Running NMF for K=10...
Running rep0:
error: 801.707825086
n_iter: 1054
Running rep1:
error: 801.707825042
n_iter: 1055
Running rep2:
error: 801.707825049
n_iter: 1055
Running rep3:
error: 801.707825047
n_iter: 1054
Running rep4:
error: 801.707825002
n_iter: 1055
  running permuted dataset...
Running rep0:
error: 903.019118663
n_iter: 8785
Running rep1:
error: 903.019113404
n_iter: 5648
Running rep2:
error: 903.019114754
n_iter: 5111
Running rep3:
error: 903.020128039
n_iter: 5550
Running rep4:
error: 903.037018996
n_iter: 3267
NMF runs finished. Results are stored in run_nmf.results and run_nmf.permuted_results.
Pickling the result object ./example_results//Results_obj.pkl...
Plotting reconstruction errors and actual iteration numbers...
Plotting ratios between the 2 top ranking genes...
Calculating result stability measurements...
Calculating stability for results...
Calculating stats on matrices G for K=5...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices G for K=6...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices G for K=7...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices G for K=8...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices G for K=9...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices G for K=10...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices C for K=5...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices C for K=6...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices C for K=7...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices C for K=8...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices C for K=9...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices C for K=10...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stability for results from permuted dataset...
Calculating stats on matrices G for K=5...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices G for K=6...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices G for K=7...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices G for K=8...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices G for K=9...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices G for K=10...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices C for K=5...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices C for K=6...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices C for K=7...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices C for K=8...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices C for K=9...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Calculating stats on matrices C for K=10...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
building connectivity matrix for rep1...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
Plotting result stability...
Pickling the result object with stability table(s)...
All done.
Run time: 240s
