K values determined:
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
Reading data...
Expression data read. Dataset dimensions:
(1860, 325)
Setting parameters for class nmf_reps...
Setting datasets for class nmf_reps...
Removing 2 all-zero rows and 0 all-zero columns...
Scaling expression data by non-zero median...
Permuting scaled expression data...
Running nmf...
Running NMF for K=11...
Running rep0:
error: 798.008997003
n_iter: 981
Running rep1:
error: 798.008997006
n_iter: 981
Running rep2:
error: 798.00899683
n_iter: 978
Running rep3:
error: 798.008995994
n_iter: 964
Running rep4:
error: 798.00899671
n_iter: 976
  running permuted dataset...
Running rep0:
error: 900.714183451
n_iter: 5603
Running rep1:
error: 900.714199286
n_iter: 3705
Running rep2:
error: 900.703650671
n_iter: 5914
Running rep3:
error: 900.703636102
n_iter: 5551
Running rep4:
error: 900.703635363
n_iter: 4076
Running NMF for K=12...
Running rep0:
error: 794.796657873
n_iter: 1461
Running rep1:
error: 794.796657464
n_iter: 1420
Running rep2:
error: 794.890582546
n_iter: 1932
Running rep3:
error: 794.890582547
n_iter: 1733
Running rep4:
error: 794.890581856
n_iter: 2715
  running permuted dataset...
Running rep0:
error: 898.206717174
n_iter: 3935
Running rep1:
error: 898.189998955
n_iter: 2536
Running rep2:
error: 898.189997071
n_iter: 5352
Running rep3:
error: 898.19592261
n_iter: 9985
Running rep4:
error: 898.195906266
n_iter: 9999
Running NMF for K=13...
Running rep0:
error: 791.701927064
n_iter: 1796
Running rep1:
error: 791.701927062
n_iter: 1815
Running rep2:
error: 791.727151541
n_iter: 1521
Running rep3:
error: 791.701927065
n_iter: 1832
Running rep4:
error: 791.727151584
n_iter: 1651
  running permuted dataset...
Running rep0:
error: 895.74832111
n_iter: 4176
Running rep1:
error: 895.729469286
n_iter: 7180
Running rep2:
error: 895.729469022
n_iter: 5547
Running rep3:
error: 895.723341726
n_iter: 9999
Running rep4:
error: 895.729468874
n_iter: 6479
Running NMF for K=14...
Running rep0:
error: 788.73156491
n_iter: 2132
Running rep1:
error: 788.76259798
n_iter: 2077
Running rep2:
error: 788.762597981
n_iter: 1967
Running rep3:
error: 788.762597984
n_iter: 2161
Running rep4:
error: 788.762597955
n_iter: 2237
  running permuted dataset...
Running rep0:
error: 893.31264655
n_iter: 5543
Running rep1:
error: 893.327916262
n_iter: 5621
Running rep2:
error: 893.323274107
n_iter: 8241
Running rep3:
error: 893.328597076
n_iter: 4830
Running rep4:
error: 893.340779545
n_iter: 9999
Running NMF for K=15...
Running rep0:
error: 785.767405562
n_iter: 1797
Running rep1:
error: 785.767407252
n_iter: 1779
Running rep2:
error: 785.767405372
n_iter: 1926
Running rep3:
error: 785.76740534
n_iter: 1946
Running rep4:
error: 785.767405531
n_iter: 1828
  running permuted dataset...
Running rep0:
error: 890.949125392
n_iter: 9999
Running rep1:
error: 890.94654131
n_iter: 8304
Running rep2:
error: 890.946526453
n_iter: 9571
Running rep3:
error: 890.958899923
n_iter: 9999
Running rep4:
error: 890.981600215
n_iter: 7878
Running NMF for K=16...
Running rep0:
error: 782.898833998
n_iter: 2599
Running rep1:
error: 783.084987195
n_iter: 1434
Running rep2:
error: 783.0776207
n_iter: 1670
Running rep3:
error: 782.898978135
n_iter: 2894
Running rep4:
error: 783.115274105
n_iter: 3578
  running permuted dataset...
Running rep0:
error: 888.644004021
n_iter: 4817
Running rep1:
error: 888.628624462
n_iter: 9999
Running rep2:
error: 888.612725709
n_iter: 9999
Running rep3:
error: 888.639033635
n_iter: 9999
Running rep4:
error: 888.574704839
n_iter: 7599
Running NMF for K=17...
Running rep0:
error: 780.311495372
n_iter: 5840
Running rep1:
error: 780.324218584
n_iter: 1936
Running rep2:
error: 780.241562499
n_iter: 2394
Running rep3:
error: 780.324414358
n_iter: 4191
Running rep4:
error: 780.201467119
n_iter: 1084
  running permuted dataset...
Running rep0:
error: 886.296052209
n_iter: 9999
Running rep1:
error: 886.305149698
n_iter: 7547
Running rep2:
error: 886.319550704
n_iter: 7658
Running rep3:
error: 886.323834099
n_iter: 7136
Running rep4:
error: 886.415945118
n_iter: 9999
Running NMF for K=18...
Running rep0:
error: 777.523140057
n_iter: 1027
Running rep1:
error: 777.675157234
n_iter: 2317
Running rep2:
error: 777.601465951
n_iter: 1270
Running rep3:
error: 777.610066006
n_iter: 2530
Running rep4:
error: 777.730454543
n_iter: 2892
  running permuted dataset...
Running rep0:
error: 884.051320904
n_iter: 9999
Running rep1:
error: 884.076492823
n_iter: 9999
Running rep2:
error: 884.030378022
n_iter: 4787
Running rep3:
error: 884.074391171
n_iter: 9999
Running rep4:
error: 884.106061217
n_iter: 9999
Running NMF for K=19...
Running rep0:
error: 774.930370983
n_iter: 1436
Running rep1:
error: 774.822986458
n_iter: 4177
Running rep2:
error: 775.039223721
n_iter: 914
Running rep3:
error: 774.849398688
n_iter: 1915
Running rep4:
error: 775.084110597
n_iter: 1569
  running permuted dataset...
Running rep0:
error: 881.85136464
n_iter: 4794
Running rep1:
error: 881.835177646
n_iter: 6591
Running rep2:
error: 881.88420446
n_iter: 3204
Running rep3:
error: 881.834268166
n_iter: 9999
Running rep4:
error: 881.863618671
n_iter: 8704
Running NMF for K=20...
Running rep0:
error: 772.353787592
n_iter: 2419
Running rep1:
error: 772.355075397
n_iter: 4329
Running rep2:
error: 772.334027666
n_iter: 2355
Running rep3:
error: 772.572247084
n_iter: 1450
Running rep4:
error: 772.44119476
n_iter: 5032
  running permuted dataset...
Running rep0:
error: 879.650393527
n_iter: 6825
Running rep1:
error: 879.656390068
n_iter: 7493
Running rep2:
error: 879.641928932
n_iter: 6589
Running rep3:
error: 879.687550726
n_iter: 3825
Running rep4:
error: 879.63269433
n_iter: 7706
NMF runs finished. Results are stored in run_nmf.results and run_nmf.permuted_results.
Pickling the result object as ../example_results_new//Results_obj_142023.pkl...
Plotting reconstruction errors and actual iteration numbers...
Plotting ratios between the 2 top ranking genes...
Calculating result stability measurements...
Calculating stability for results...
Calculating stats on matrices G for K=11...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=12...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=13...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=14...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=15...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=16...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=17...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=18...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=19...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=20...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=11...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=12...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=13...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=14...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=15...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=16...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=17...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=18...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=19...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=20...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stability for results from permuted dataset...
Calculating stats on matrices G for K=11...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=12...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=13...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=14...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=15...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=16...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=17...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=18...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=19...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices G for K=20...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=11...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=12...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=13...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=14...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=15...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=16...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=17...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=18...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=19...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Calculating stats on matrices C for K=20...
building connectivity matrix for rep0...
building connectivity matrix for rep2...
building connectivity matrix for rep1...
building connectivity matrix for rep4...
building connectivity matrix for rep3...
Plotting result stability...
Pickling the result object with stability table(s)...
All done.
Run time: 839s
